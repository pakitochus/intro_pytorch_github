<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introducción a Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Introducción a Pytorch_solucion_files/libs/clipboard/clipboard.min.js"></script>
<script src="Introducción a Pytorch_solucion_files/libs/quarto-html/quarto.js"></script>
<script src="Introducción a Pytorch_solucion_files/libs/quarto-html/popper.min.js"></script>
<script src="Introducción a Pytorch_solucion_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Introducción a Pytorch_solucion_files/libs/quarto-html/anchor.min.js"></script>
<link href="Introducción a Pytorch_solucion_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Introducción a Pytorch_solucion_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Introducción a Pytorch_solucion_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Introducción a Pytorch_solucion_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Introducción a Pytorch_solucion_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducción a Python</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Python es un lenguaje de programación. Sirve para dar instrucciones a un ordenador. Un curso de introducción a python nos llevaría varias horas, pero vamos a intentar sintetizar los conocimientos básicos aquí. En primer lugar, podemos hacer operaciones:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5</code></pre>
</div>
</div>
<p>También podemos utilizar variables:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>var2 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>var1<span class="op">+</span>var2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>5</code></pre>
</div>
</div>
<p>que se mantienen en el tiempo:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>var1<span class="op">+</span>var2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>4</code></pre>
</div>
</div>
<p>Y que podemos almacenar y mostrar por pantalla:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>var3 <span class="op">=</span> var1 <span class="op">+</span> var2</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(var3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<p>También hay funciones, que son básicamente “apodos” para una serie de operaciones, como una receta de cocina:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suma(x, y):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> y </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>var4 <span class="op">=</span> suma(var1, var2)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(var4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
</div>
<p>Podemos hacer que una función o varias operaciones se repitan en el tiempo usando bucles como <code>for</code>, y controlar cuando se realiza algo con expresiones como <code>if</code> y <code>else</code>:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiplica(x,y):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">*</span>y</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>acum <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    acum <span class="op">=</span> suma(acum, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    acum <span class="op">=</span> multiplica(acum, <span class="dv">2</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>acum <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">%</span><span class="dv">2</span><span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        acum <span class="op">=</span> suma(acum, <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(acum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6</code></pre>
</div>
</div>
<p>Y por último, a nivel básico, tenemos librerías, que contienen funciones. Como <code>numpy</code>, la librería estándar para trabajar con matrices. O <code>pytorch</code>, la que vamos a usar en este curso para realizar redes neuronales:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">sum</span>(array))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.prod(array))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3
2</code></pre>
</div>
</div>
<section id="programando-con-pytorch" class="level1">
<h1>Programando con Pytorch</h1>
<p>Pytorch es una librería (o lo que se conoce como un <em>framework</em>) que reúne una serie de utilidades para trabajar con cálculo tensorial. Un Tensor es la versión N-dimensional de una matriz, que puede tener un número arbitrario de dimensiones.</p>
<p>El manejo eficiente de los tensores, y su posibilidad de utilizarlos en procesadores paralelos como las tarjetas gráficas (GPUs) es lo que ha catapultado la revolución del <em>deep learning</em> desde el año 2013.</p>
<p>Hay muchas librerías para trabajar con tensores, entre ellas la más conocida: <code>Tensorflow</code>. Sin embargo, pytorch está ganando mucha fuerza en los últimos años, ya que está soportado por Facebook, y es usado activamente en grandes empresas como Uber, Salesforce o Tesla.</p>
<p>Los más familiares con el lenguaje Python para cálculos técnicos y científicos seguramente conozcan <code>numpy</code>. Pytorch está organizado de forma muy similar, pero para igualar el nivel, y comenzar desde cero, vamos a dar nuestros primeros pasos.</p>
<section id="primeros-pasos-con-pytorch" class="level2">
<h2 class="anchored" data-anchor-id="primeros-pasos-con-pytorch">Primeros pasos con Pytorch</h2>
<p>Vamos a crear nuestro primer tensor, a partir de datos directamente, de arrays o de otros tensores. En primer lugar cargamos las librerías necesarias:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como véis hemos cargado también numpy, aunque no nos hará falta en este tutorial. Vamos a crear nuestro primer tensor <strong>a partir de datos</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x_data <span class="op">=</span> torch.tensor(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos comprobar qué hay dentro de la variable <code>x_data</code> así:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:314,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628236683422,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="133f234b-b60b-4a4b-c662-0cfca90985e3">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[1, 2],
        [3, 4]])</code></pre>
</div>
</div>
<p>Vemos que es una estructura similar a una matriz pero de tipo tensor. Vamos a crear ahora otros datos a partir de un array de numpy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>np_array <span class="op">=</span> np.array(data)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x_np <span class="op">=</span> torch.from_numpy(np_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto es muy útil en los casos en que dispongamos de datos como arrays de numpy (caso muy frecuente en la vida real). Por último, vamos a crear tensores a partir de otros tensores de pytoch:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:263,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628236824183,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="3946648d-1563-4c51-a5e3-1fd687f3f3f4">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x_ones <span class="op">=</span> torch.ones_like(x_data) <span class="co"># creamos un tensor de 1 con las dimensiones de x_data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor de unos: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>x_ones<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x_rand <span class="op">=</span> torch.rand_like(x_data, dtype<span class="op">=</span>torch.<span class="bu">float</span>) <span class="co"># tensor aleatorio con datos "float"</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor random: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>x_rand<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor de unos: 
 tensor([[1, 1],
        [1, 1]])

Tensor random: 
 tensor([[0.8679, 0.6779],
        [0.9502, 0.9748]])
</code></pre>
</div>
</div>
<p>Hemos utilizado print para mostrar los datos de los tensores.</p>
<p>Hemos visto que podemos generar un tensor de unos con un tamaño igual al de un tensor dado. Pero también podemos generar valores aleatorios o constantes a partir de las dimensiones del tensor, lo que conocemos como <code>shape</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:350,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628236961130,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="d02fe5a0-1305-4be4-df9e-5920b3a9e8be">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">3</span>,)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rand_tensor <span class="op">=</span> torch.rand(shape)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ones_tensor <span class="op">=</span> torch.ones(shape)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>zeros_tensor <span class="op">=</span> torch.zeros(shape)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor Aleatorio: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>rand_tensor<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor Unos: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>ones_tensor<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor Ceros: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>zeros_tensor<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor Aleatorio: 
 tensor([[0.4624, 0.8898, 0.0245],
        [0.2815, 0.9504, 0.9245]])

Tensor Unos: 
 tensor([[1., 1., 1.],
        [1., 1., 1.]])

Tensor Ceros: 
 tensor([[0., 0., 0.],
        [0., 0., 0.]])</code></pre>
</div>
</div>
</section>
<section id="atributos-de-los-tensores" class="level2">
<h2 class="anchored" data-anchor-id="atributos-de-los-tensores">Atributos de los tensores</h2>
<p>Los tensores son en realidad un “objeto”. No sólo contienen los datos en sí (ceros, unos, etc), sino uqe también tienen unas propiedades y unos métodos que es posible visualizar, y que nos van a ayudar mucho en la vida. Generemos un tensor aleatorio y vamos a ver varias de estas propiedades y funciones:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237081259,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="71023304-44ba-4baf-b8f8-753e62d1d705">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tensor <span class="op">=</span> torch.rand(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dimensiones del tensor: </span><span class="sc">{</span>tensor<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tipo de dato del tensor: </span><span class="sc">{</span>tensor<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dispositivo en el que está almacenado el tensor: </span><span class="sc">{</span>tensor<span class="sc">.</span>device<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Valor medio del tensor: </span><span class="sc">{</span>tensor<span class="sc">.</span>mean()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dimensiones del tensor: torch.Size([3, 4])
Tipo de dato del tensor: torch.float32
Dispositivo en el que está almacenado el tensor: cpu
Valor medio del tensor: 0.40055403113365173</code></pre>
</div>
</div>
</section>
<section id="operaciones-con-tensores" class="level2">
<h2 class="anchored" data-anchor-id="operaciones-con-tensores">Operaciones con tensores</h2>
<p>Existen más de 100 operaciones soportadas por la librería de pytorch. Estos incluyen desde el <em>slicing</em> o acceso a partes del tensor, hasta multiplicaciones y funciones más avanzadas. Vamos a comenzar viendo cómo acceder a los distintos elementos de un tensor, el famoso <em>slicing</em>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:452,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237468121,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="e53ae80e-2713-42fb-d9bf-8376c46b725e">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tensor <span class="op">=</span> torch.ones(<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor[<span class="dv">0</span>,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])
tensor(1.)</code></pre>
</div>
</div>
<p>Al ser un tensor sólo relleno de unos, daría igual, pero hemos accedido a la posición del tensor en la fila 0, la columna 2. Recuerda que en casi todos los lenguajes de programación, la primera posición de un vector, array o lo que sea es 0.</p>
<p>Podemos modificar partes de un tensor utilizando <em>slicing</em>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237470886,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="1f92a153-43e7-4d72-e360-aa91d99266e3">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tensor[:,<span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.]])</code></pre>
</div>
</div>
<p>Podemos recuperar un subtensor mediante estas técnicas. Por ejemplo, para obtener las filas de la 0 a la 2, y las columnas de la 1 en adelante, usamos:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237377700,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="dfe17a46-7fe0-498b-d51a-950641a059e0">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor[:<span class="dv">3</span>, <span class="dv">1</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[0., 1., 1.],
        [0., 1., 1.],
        [0., 1., 1.]])</code></pre>
</div>
</div>
<p>Podemos también concatenar diferentes tensores en una dimension dada. Existen varias funciones para esto, como <code>torch.cat</code> o <code>torch.stack</code>. Aquí nos centraremos en una, pero la documentación de pytorch es bastante completa en este sentido.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:312,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237535300,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="9a67e0c8-fcae-4851-8fb3-a49c320d2baa">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> torch.cat([tensor, tensor, tensor], dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],
        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],
        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.],
        [1., 0., 1., 1., 1., 0., 1., 1., 1., 0., 1., 1.]])</code></pre>
</div>
</div>
<p>Podemos sumar varios tensores:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:266,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237815978,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="5117ff06-010d-4d00-a7b4-d5328a99757e">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tensor2 <span class="op">=</span> torch.rand_like(tensor)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tensor2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Suma: </span><span class="ch">\n</span><span class="sc">{</span>tensor<span class="op">+</span>tensor2<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[0.8648, 0.5517, 0.7192, 0.1277],
        [0.8661, 0.2795, 0.0468, 0.0321],
        [0.7303, 0.5403, 0.6252, 0.1478],
        [0.9980, 0.3105, 0.2492, 0.9086]])
Suma: 
tensor([[6.8648, 5.5517, 6.7192, 6.1277],
        [6.8661, 5.2795, 6.0468, 6.0321],
        [6.7303, 5.5403, 6.6252, 6.1478],
        [6.9980, 5.3105, 6.2492, 6.9086]])</code></pre>
</div>
</div>
<p>Vamos a multiplicar tensores entre sí, elemento a elemento (no confundir con producto de matrices):</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:239,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237633933,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="8907d103-b90d-4e41-a6e4-455ef844d6b1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"tensor*tensor </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor<span class="op">*</span>tensor<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#O una versión alternativa:</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"tensor.mul(tensor) </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor<span class="sc">.</span>mul(tensor)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor*tensor 
 tensor([[1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.]])
tensor.mul(tensor) 
 tensor([[1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.],
        [1., 0., 1., 1.]])</code></pre>
</div>
</div>
<p>Para multiplicar tensores en forma matricial, podemos hacer uso de las dos sintaxis vistas anteriormente:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628237676305,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="214b41a8-9a11-4e1c-ba37-c85a9b144aef">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"tensor.matmul(tensor.T) </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor<span class="sc">.</span>matmul(tensor.T)<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternativa:</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"tensor @ tensor.T </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor <span class="op">@</span> tensor<span class="sc">.</span>T<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor.matmul(tensor.T) 
 tensor([[3., 3., 3., 3.],
        [3., 3., 3., 3.],
        [3., 3., 3., 3.],
        [3., 3., 3., 3.]]) 

tensor @ tensor.T 
 tensor([[3., 3., 3., 3.],
        [3., 3., 3., 3.],
        [3., 3., 3., 3.],
        [3., 3., 3., 3.]])</code></pre>
</div>
</div>
<p>## Jugando con los procesadores Todas estas pueden ser realizadas en la CPU (procesador del ordenador) o la GPU (procesador gráfico, más rápido para operaciones paralelas). Por defecto, los tensores están creados en la CPU, pero podemos moverlos entre ambas. Como estamos en Colab, si por defecto no tenemos GPU podemos hacerlo en “Entorno de Ejecución&gt; Cambiar tipo de entorno de ejecución”, y seleccionar un acelerador por GPU.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  tensor_cuda <span class="op">=</span> tensor.to(<span class="st">'cuda'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:250,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1628237885411,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="eca0dfc7-9f52-452c-fd39-b9553cfac6a3">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(tensor))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(tensor_cuda))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'torch.Tensor'&gt;</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>NameError: ignored</code></pre>
</div>
</div>
</section>
</section>
<section id="torch.autograd-la-magia-está-servida" class="level1">
<h1><code>Torch.autograd</code>, la magia está servida</h1>
<p>Como hemos comentado anteriormente, las redes neuornales están definidas fundamentalmente por tres pasos: 1. <strong>Propagación hacia adelante</strong> (<em>forward pass</em>): se introduce unos datos en la red y se realizan los cálculos necesarios hasta dar una salida. 2. <strong>Cálculo de la pérdida</strong> (<em>loss</em>). Se compara la salida de la red con la salida esperada para cuantificar lo “acertado” de nuestra red. 3. <strong>Propagación hacia atrás</strong> (<em>backward pass</em> o <em>backpropagation</em>). Se calcula el gradiente de la pérdida con respecto a cada entrada y salida de las neuronas, y se ajustan los parámetros</p>
<p>Para el último paso, es importante ser capaces de calcular el gradiente, el diferencial de una entrada con respecto a una salida, para poder actualizar los pesos de la red neuronal. Pero, ¿cómo calculamos el gradiente automáticamente?</p>
<p>Ahí está el truco del almendruco. <code>torch.autograd</code> lo hace por nosotros.</p>
<p>¿Cómo? Allá vamos!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> torch.tensor([<span class="fl">2.</span>, <span class="fl">3.</span>], requires_grad<span class="op">=</span><span class="va">True</span>) </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> torch.tensor([<span class="fl">6.</span>, <span class="fl">4.</span>], requires_grad<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como véis es muy similar a lo que hemos realizado anteriormente, pero en este caso añadimos la coletilla <code>requires_grad</code>. Ésto significa que vamos a almacenar el gradiente, una “memoria” de la operación a realizar. Veamos qué ocurre si queremos calcular <span class="math inline">\(Q = 3a^3 - b^2\)</span>.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628238324505,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="d8dd3743-7521-4ea6-fa73-8988417b2b90">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>a<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> b<span class="op">**</span><span class="dv">2</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([-12.,  65.], grad_fn=&lt;SubBackward0&gt;)</code></pre>
</div>
</div>
<p>Vemos que en este caso se ha almacenado una <code>grad_fn</code>, la función con respecto a la cual calcular el gradiente. Siendo <code>SubBackward</code>, podemos asumir que es 0.</p>
<p>Internamente, el programa está haciendo lo siguiente:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data:image/png;base64,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.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image.png</figcaption>
</figure>
</div>
<p>Así, de esta manera podríamos calcular los gradientes de Q con respecto a los tensores <code>a</code> y <code>b</code>: <span class="math display">\[\frac{\partial Q}{\partial a} = 9a^2\]</span> <span class="math display">\[\frac{\partial Q}{\partial b} = -2b\]</span></p>
<p>Como hemos calculado Q a partir de tensores con la opción <code>requires_grad</code>, damos la orden de calcular todos los gradientes parciales usando la propiedad <code>.backward()</code>. Ya que Q es una matriz, necesitamos calcular el tope, podríamos usar <code>.sum()</code> o definir un gradiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Q.<span class="bu">sum</span>().backward()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con este dato, ya hemos almacenado los gradientes, y comprobamos si están bien calculados comparándolos con los calculados a mano:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:448,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628238619619,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="65c55910-7aee-437f-f20e-b56fe177e56a">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">9</span><span class="op">*</span>a<span class="op">**</span><span class="dv">2</span> <span class="op">==</span> a.grad)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>b <span class="op">==</span> b.grad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([True, True])
tensor([True, True])</code></pre>
</div>
</div>
<section id="autograd-para-aprendizaje-automático" class="level2">
<h2 class="anchored" data-anchor-id="autograd-para-aprendizaje-automático">Autograd para aprendizaje automático</h2>
<p>Así pues, este procedimiento es el que se realiza para crear modelos de aprendizaje automático. Por ejemplo, vamos a realizar una regresión simple. La regresión, si recordamos, trata de relacionar dos variables <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> (que habitualmente se conocen como variable independiente y variable dependiente) de la forma:</p>
<p><span class="math display">\[ y = w*x + b\]</span></p>
<p>Vamos a intentar estimar <span class="math inline">\(w\)</span> y <span class="math inline">\(b\)</span> a partir de los datos siguientes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos para regresión lineal </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.Tensor([<span class="fl">3.3</span>,<span class="fl">4.4</span>,<span class="fl">5.5</span>,<span class="fl">6.71</span>,<span class="fl">6.93</span>,<span class="fl">4.168</span>,<span class="fl">9.779</span>,<span class="fl">6.182</span>,<span class="fl">7.59</span>,<span class="fl">2.167</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">7.042</span>,<span class="fl">10.791</span>,<span class="fl">5.313</span>,<span class="fl">7.997</span>,<span class="fl">5.654</span>,<span class="fl">9.27</span>,<span class="fl">3.1</span>]).view(<span class="dv">17</span>, <span class="dv">1</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch.Tensor([<span class="fl">1.7</span>,<span class="fl">2.76</span>,<span class="fl">2.09</span>,<span class="fl">3.19</span>,<span class="fl">1.694</span>,<span class="fl">1.573</span>,<span class="fl">3.366</span>,<span class="fl">2.596</span>,<span class="fl">2.53</span>,<span class="fl">1.221</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                         <span class="fl">2.827</span>,<span class="fl">3.465</span>,<span class="fl">1.65</span>,<span class="fl">2.904</span>,<span class="fl">2.42</span>,<span class="fl">2.94</span>,<span class="fl">1.3</span>]).view(<span class="dv">17</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una buena práctica para saber qué estamos haciendo es mostrarlo. Para ello utilizamos la librería de mostrar gráficos <code>matplotlib</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:541,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240381480,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="28f5a3c9-4098-424d-856a-c221777056a4">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Muestra los datos</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, color <span class="op">=</span> <span class="st">"orange"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Variable Independiente'</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Variable Dependiente'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>Text(0, 0.5, 'Variable Dependiente')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Introducción%20a%20Pytorch_solucion_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Observamos que hay una clara tendencia lineal entre la variable independiente y la variable dependiente. Para entrenar el modelo, tenemos que partir de unos parámetros <span class="math inline">\(w\)</span> y <span class="math inline">\(b\)</span> aleatorios:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240382784,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="6d77cb86-feb6-44de-b4f9-2818d276735f">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> torch.randn(<span class="dv">1</span>, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> torch.randn(<span class="dv">1</span>, requires_grad<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([-0.0286], requires_grad=True)
tensor([0.3545], requires_grad=True)</code></pre>
</div>
</div>
<p>Y a continuación definiremos nuestro modelo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model(x):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">@</span> w.t() <span class="op">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La matriz que obtenemos como salida del modelo serán las predicciones:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:389,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240422262,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="db8fd937-2aed-474c-f04a-f0f7531bbeac">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> model(x)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(preds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([0.3645, 0.3664, 0.3683, 0.3704, 0.3707, 0.3660, 0.3756, 0.3695, 0.3719,
        0.3626, 0.3709, 0.3774, 0.3680, 0.3726, 0.3685, 0.3748, 0.3642],
       grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<p>Esto, en una red neuronal, sería el <strong>forward pass</strong>. En este modelo, sin entrenar, nos daría la siguiente recta:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:33,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240422624,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="4292125b-da57-4c2f-9233-8340872e2e2d">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, color <span class="op">=</span> <span class="st">"orange"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Variable Independiente'</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Variable Dependiente'</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, preds.detach(), <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">3</span>) <span class="co"># cuidado con .detach(), matplotlib no puede mostrar cosas que almacenen gradiente. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Introducción%20a%20Pytorch_solucion_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Para comparar las predicciones con las originales definimos una función de loss. Para un ajuste por mínimos cuadrados utilizamos el error cuadrático medio: <span class="math display">\[ \frac{1}{N}\sum{(preds-y)^2}\]</span></p>
<p>Afortunadamente, esta es una de las funciones más utilizadas en aprendizaje, así que está en pytorch almacenada como <code>torch.nn.MSELoss()</code></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240422957,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="94992a01-b513-44c4-f8cf-221375381551">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>loss_func <span class="op">=</span> torch.nn.MSELoss()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> loss_func(preds.view(<span class="dv">17</span>,<span class="dv">1</span>), y)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor(4.4831, grad_fn=&lt;MseLossBackward&gt;)</code></pre>
</div>
</div>
<p>Como hemos visto antes, ahora hay que computar el gradiente con respecto a cada peso, y actualizar los mismos para que aprenda:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240423208,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="91505d5f-97fc-4f78-8b63-a615702bbad9">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>loss.backward()</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w.grad)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(b.grad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([-27.6149])
tensor([-3.9934])</code></pre>
</div>
</div>
<p>Para ajustar los pesos, utilizaríamos una constante (<em>learning rate</em>) que multiplicamos por el gradiente, y tendríamos una nueva estimación:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240423500,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="8a9d5cca-59c7-49b3-a520-69be32b27b68">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  w <span class="op">-=</span> w.grad<span class="op">*</span><span class="fl">1e-2</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  b <span class="op">-=</span> b.grad<span class="op">*</span><span class="fl">1e-2</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(w)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  w.grad.zero_()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  b.grad.zero_()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([0.2779], requires_grad=True)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240424049,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="21cd6367-3570-45a8-e984-af4b40d5aec1">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([0.2779], requires_grad=True)
tensor([0.3988], requires_grad=True)</code></pre>
</div>
</div>
<p>Y ya hemos visto cómo se han actualizado los pesos. Esto daría lugar a la siguiente recta:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:530,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240424935,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="5dc1ec7b-a773-42d3-deec-2b7d6313cf24">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> model(x)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, color <span class="op">=</span> <span class="st">"orange"</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Variable Independiente'</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Variable Dependiente'</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, preds.detach(), <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">3</span>) <span class="co"># cuidado con .detach(), matplotlib no puede mostrar cosas que almacenen gradiente. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Introducción%20a%20Pytorch_solucion_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="regresión-como-una-red-neuronal" class="level2">
<h2 class="anchored" data-anchor-id="regresión-como-una-red-neuronal">Regresión como una red neuronal</h2>
<p>El algoritmo que hemos definido se llama descenso de gradiente, y está implementado también en pytorch como <code>pytorch.optim.SGD</code>. Asimismo, los parámetros del modelo se pueden ver como una capa lineal de 2 neuronas, como ya hemos visto. De este modo podemos construir un modelo de red neuronal para regresión muy sencillo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Regresion(torch.nn.Module):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, inputSize, outputSize):</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Regresion, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.linear <span class="op">=</span> torch.nn.Linear(inputSize, outputSize)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        out <span class="op">=</span> <span class="va">self</span>.linear(x)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora podemos definir la red, el optimizador y el loss:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Regresion(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>loss_func <span class="op">=</span> torch.nn.MSELoss()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.SGD(model.parameters(), lr<span class="op">=</span><span class="fl">0.01</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y podremos realizar el bucle de entrenamiento:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:316,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240589231,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="d590ade5-c4ac-478b-9665-d4977fced3e4">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> e <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">20</span>):</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  optimizer.zero_grad() <span class="co"># nos aseguramos que todos los grad. estén a 0</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  preds <span class="op">=</span> model(x) <span class="co"># forward pass</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> loss_func(preds.view(<span class="dv">17</span>,<span class="dv">1</span>), y) </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  loss.backward() <span class="co"># backward pass</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  optimizer.step()</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Step: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">, Loss: </span><span class="sc">{</span>loss<span class="sc">.</span>item()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Step: 0, Loss: 61.8243408203125
Step: 1, Loss: 0.7637394070625305
Step: 2, Loss: 0.19162237644195557
Step: 3, Loss: 0.1861078441143036
Step: 4, Loss: 0.18590152263641357
Step: 5, Loss: 0.18574562668800354
Step: 6, Loss: 0.18559102714061737
Step: 7, Loss: 0.1854371428489685
Step: 8, Loss: 0.18528400361537933
Step: 9, Loss: 0.18513157963752747
Step: 10, Loss: 0.18497994542121887
Step: 11, Loss: 0.1848290115594864
Step: 12, Loss: 0.1846788227558136
Step: 13, Loss: 0.1845293492078781
Step: 14, Loss: 0.18438062071800232
Step: 15, Loss: 0.18423259258270264
Step: 16, Loss: 0.18408526480197906
Step: 17, Loss: 0.18393872678279877
Step: 18, Loss: 0.18379279971122742
Step: 19, Loss: 0.18364763259887695</code></pre>
</div>
</div>
<p>Y visualizamos el resultado de nuestra regresión</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:330,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240616350,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="91e95316-95e0-4c49-c04a-0b962212fe84">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> model(x)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, color <span class="op">=</span> <span class="st">"orange"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Variable Independiente'</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Variable Dependiente'</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, preds.detach(), <span class="st">'b-'</span>, lw<span class="op">=</span><span class="dv">3</span>) <span class="co"># cuidado con .detach(), matplotlib no puede mostrar cosas que almacenen gradiente. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Introducción%20a%20Pytorch_solucion_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Y los valores de nuestras variables:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:310,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1628240664387,&quot;user&quot;:{&quot;displayName&quot;:&quot;Francisco Jesús Martínez Murcia&quot;,&quot;photoUrl&quot;:&quot;https://lh3.googleusercontent.com/a-/AOh14GhzgBZcFuyJrkZuD_zFRzufYcbUPTEDHG6SivzaSV0=s64&quot;,&quot;userId&quot;:&quot;13684743367188921611&quot;},&quot;user_tz&quot;:-120}" data-outputid="c9fc429f-e0db-4dde-fcd6-61fb141ac4b7">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'w es: </span><span class="sc">{</span>model<span class="sc">.</span>linear<span class="sc">.</span>weight<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'b es: </span><span class="sc">{</span>model<span class="sc">.</span>linear<span class="sc">.</span>bias<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>w es: Parameter containing:
tensor([[0.3207]], requires_grad=True)
b es: Parameter containing:
tensor([0.3094], requires_grad=True)</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>